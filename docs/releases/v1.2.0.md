## Woo's NWN Log Parser v1.2.0

A tool for analyzing Neverwinter Nights combat logs with DPS calculations and detailed combat statistics.

### Download

**One File approach** (simple single file, more prone to false-positive AV flags): Download `WoosNwnParser.exe` below and run it.

**One Directory approach** (directory with many files, less false-positive AV flags): Download `WoosNwnParser.zip` below, extract everything to a directory, and run `WoosNwnParser.exe`.

**Windows Security Notice**: Windows may show a SmartScreen warning because this is a new application. Click "More info" â†’ "Run anyway" to proceed. This is normal for new, unsigned applications.

### Security Scan

**One File approach**: VirusTotal: [1/71 vendors flagged](https://www.virustotal.com/gui/file/ed3f89bb6a2bb9a45f82d52d5b05e90ff55d25a40ea14d79e0e0af0e6364b3b0)

**One Directory approach**: VirusTotal: [2/71 vendors flagged](https://www.virustotal.com/gui/file/594ac0f5ca67300ca412b6b0132fa0a759896a2cea38eafadd251627b70f67d2)

These are false positives common with unsigned Python executables. The detections are generic ML-based flags, not specific malware signatures. Source code is available for inspection.

### Features

- Real-time combat log parsing
- DPS calculations with time tracking modes
- Damage type breakdown
- Target filtering
- Hit rate statistics
- AB, AC, Saves per target
- Damage immunities per target

### System Requirements

- Windows 10/11
- No installation required - just run the exe

### Changelog

#### Added
- **Target Stats Panel** - New "Damage Taken" column showing total damage each target has received
  - Displays the sum of all damage dealt to each target from all attackers
  - Column is sortable like all other columns in the panel

#### Changed
- **UI Performance Optimizations** - Improved tab switching and panel refresh responsiveness
  - **Dirty Flag Refresh**: `poll_log_file()` now only calls `refresh_targets()` when data has actually changed, using a version counter in DataStore. Eliminates redundant refreshes every 500ms when idle.
  - **Optimized Sorting**: `SortedTreeview.apply_current_sort()` now checks if data is already in correct order before sorting, skipping O(n log n) sort operations when unnecessary.
  - **Batch Visual Updates**: Target Stats and Immunity panels now suppress Treeview repaints during bulk insert operations using `tree.configure(show="")` pattern, reducing layout recalculations.
  - **DataStore Version Tracking**: Added `version` property to DataStore that increments on every data modification, enabling efficient change detection.
